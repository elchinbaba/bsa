(this["webpackJsonpbinary-studio-academy-client"]=this["webpackJsonpbinary-studio-academy-client"]||[]).push([[54],{1983:function(e,t,a){},2128:function(e,t,a){"use strict";a.r(t);var r=a(43),s=a(4),n=a.n(s),o=a(37),c=a(59),i=a(2),u=a(0),l=a(86),d=a(5),j=a(553),p=a(557),m=a(128),b=a(596),h=a(35),g=a.n(h),v=a(200),O=a(31),x=a(241),f=a(8),k=a(9),w=a(20),R=a(21),A=a(30),y=a(47),N=a(12),I=a(16),S=a(706),T=a(750),C=a(49),M=function(e){Object(w.a)(a,e);var t=Object(R.a)(a);function a(e){var r;return Object(f.a)(this,a),(r=t.call(this,e)).socketListener=function(e){if(e.errorCode){var t=Object(S.a)(e.errorCode);r.setState({lastAutogradeResult:null,waiting:!1,errorMessage:t})}else r.setState({lastAutogradeResult:e.autogradeResult,waiting:!1})},r.joinToRoom=function(){r.props.actions.joinToAutogradeRoom(r.props.userId,r.props.homeworkResponse.id),r.props.activeSocket.on(d.SocketEventType.NewAutogradeResult,r.socketListener)},r.checkHomeworkStatus=Object(o.a)(n.a.mark((function e(){var t,a,s,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.props.homeworkResponse,a=t.studentWaitForAutogradeResult,s=t.id,e.next=4,x.a.getAutogradeResults(s,1,"createdAt","DESC");case 4:o=e.sent,r.setState({waiting:a,lastAutogradeResult:o.data[0]}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),r.state.fatalError||(r.setState({fatalError:!0}),r.props.actions.addCommonAlert({status:N.a.error,formattedMessageId:"autogradeResultViewError",defaultMessage:"Something was wrong with your autograde result"}));case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),r.state={waiting:e.homeworkResponse.studentWaitForAutogradeResult,fatalError:!1,lastAutogradeResult:null,errorMessage:null},r}return Object(k.a)(a,[{key:"componentDidMount",value:function(){var e=Object(o.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkHomeworkStatus();case 2:this.props.userId&&this.props.homeworkResponse&&this.props.homeworkResponse.id&&(this.joinToRoom(),this.props.activeSocket.addEventListener(d.SocketEventType.Reconnect,this.joinToRoom.bind(this))),this.props.ownLastAutogradeResult&&this.setState({lastAutogradeResult:this.props.ownLastAutogradeResult});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(o.a)(n.a.mark((function e(t,a){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.props.parentInstructions&&!this.state.waiting&&a.waiting&&this.props.parentInstructions();case 1:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.props.activeSocket.off(d.SocketEventType.NewAutogradeResult,this.socketListener),this.props.actions.leaveAutogradeRoom(this.props.userId,this.props.homeworkResponse.id)}},{key:"render",value:function(){var e=this.state,t=e.waiting,a=e.errorMessage,r=e.fatalError,s=e.lastAutogradeResult,n=this.props,o=n.traceAccordingText,c=n.minMark;return r?null:Object(i.jsx)(T.a,{traceAccordingText:s&&c&&s.mark<=c&&o,onlyTrace:!0,waiting:t,autogradeResult:s,errorMessage:a})}}]),a}(u.Component),E=Object(A.c)((function(e){return{activeSocket:e.socket.activeSocket}}),(function(e){return{actions:Object(y.bindActionCreators)({addCommonAlert:I.a.addCommonAlert,joinToAutogradeRoom:C.a.joinToAutogradeRoom,leaveAutogradeRoom:C.a.leaveAutogradeRoom},e)}}))(M),L=a(119),H=a(203),B=(a(1983),a(204)),F=a(87),W=a(129),V=function(e){var t=e.reviewBody,a=e.minMark,r=e.userId,s=e.onlyTrace,n=e.homeworkResponse,o=e.parentInstructions,d=e.traceAccordingText,p=e.showAutogradeResult,m=Object(u.useState)(!1),b=Object(c.a)(m,2),h=b[0],g=b[1];return Object(i.jsxs)("div",{className:"lecture-task",children:[Object(i.jsx)(F.a,{icon:W.j,onClick:function(){return g(!0)}}),Object(i.jsx)(B.a,{show:h,handleClose:function(){return g(!1)},children:Object(i.jsxs)("div",{className:"modal-review-block",children:[Object(i.jsx)("div",{className:"modal-lecture-header-data",children:Object(i.jsx)("h3",{className:"modal-lecture-info-header",children:Object(i.jsx)(l.a,{id:"userCabinet.answerChecked"})})}),Object(i.jsx)("div",{className:"modal-review-block-text",children:Object(i.jsx)(j.a,{source:t,escapeHtml:!1})}),p&&Object(i.jsx)(i.Fragment,{children:Object(i.jsx)(E,{minMark:a,traceAccordingText:d,userId:r,onlyTrace:s,homeworkResponse:n,parentInstructions:o})})]})})]})};t.default=function(e){var t=e.homework,a=e.homeworkResponse,s=e.disableSubmit,h=e.onAnswerSubmit,f=e.onHomeworkResponseChanged,k=e.needRepo,w=e.attemptsLimit,R=e.showAutogradeResult,A=e.userId,y=e.repoType,N=e.hasAutograde,I=e.traceAccordingText,S=e.minMark,T=N&&(null===a||void 0===a?void 0:a.attempts)&&(null===a||void 0===a?void 0:a.attempts)>=w,C=Object(H.p)(y),M=Object(c.a)(C,2),B=M[0],F=M[1],W=Object(u.useState)(Object(O.get)(a,"body","")),_=Object(c.a)(W,2),D=_[0],U=_[1],J=Object(u.useState)(Object(O.get)(a,"repoLink","")),q=Object(c.a)(J,2),P=q[0],Y=q[1],z=Object(u.useState)(""),G=Object(c.a)(z,2),K=G[0],Q=G[1],X=Object(u.useState)(!0),Z=Object(c.a)(X,2),$=Z[0],ee=Z[1],te=Object(u.useState)(!a),ae=Object(c.a)(te,2),re=ae[0],se=ae[1];Object(u.useEffect)((function(){ee(a&&a.studentWaitForAutogradeResult||s||!!K||k&&!P||!k&&!P&&!D||T||N&&!R&&a&&a.attempts&&a.attempts>=1)}),[s,K,N,a,k,D,P,R,T]),Object(u.useEffect)((function(){a&&a.notificationStatus!==d.NotificationStatus.None&&function(){var e=Object(o.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.updateStatus(a.id);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[a]);var ne=function(){var e=Object(o.a)(n.a.mark((function e(){var t,r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.getOne(a.id);case 3:t=e.sent,r=t.data,f(r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),oe=s||T||!re,ce=Boolean(a&&a.repoLink),ie=!a||a&&!a.isReviewed,ue=a&&a.mark&&Object(b.a)(a.mark);return Object(i.jsxs)("div",{className:"lecture-task",children:[Object(O.get)(a,"isReviewed",!1)&&Object(i.jsxs)("div",{className:"lecture-task-part review",children:[Object(i.jsx)("div",{className:g()("mark-block",Object(r.a)({},"mark-block-".concat(ue),ue)),children:Object(i.jsx)("span",{children:a.mark})}),Object(i.jsxs)("div",{className:"review-block",children:[Object(i.jsxs)("div",{className:"lecture-header-data",children:[Object(i.jsx)("h3",{className:"lecture-info-header",children:Object(i.jsx)(l.a,{id:"userCabinet.answerChecked"})}),Object(i.jsx)(V,{homeworkResponse:a,parentInstructions:ne,reviewBody:a.reviewBody,showAutogradeResult:R&&ce,traceAccordingText:I,minMark:S,userId:A,onlyTrace:!0})]}),Object(i.jsx)("div",{className:"review-block-text",children:Object(i.jsx)(j.a,{source:a.reviewBody,escapeHtml:!1})}),R&&ce&&Object(i.jsx)(i.Fragment,{children:Object(i.jsx)(E,{minMark:S,traceAccordingText:I,userId:A,onlyTrace:!0,homeworkResponse:a,parentInstructions:ne})})]})]}),Object(i.jsxs)("div",{className:"lecture-task-part",children:[Object(i.jsx)("h3",{className:"lecture-info-header",children:Object(i.jsx)(l.a,{id:"userCabinet.answer"})}),Object(i.jsxs)("div",{className:"lecture-answer-body",children:[k&&Object(i.jsx)(v.a,{name:"repoLink",labelText:"Repo",placeHolderIntlId:"repoLinkPlaceholder",value:re?P:null===a||void 0===a?void 0:a.repoLink,onChange:function(e){var t=B.isValidSync(e.target.value);Y(e.target.value);var a=!e.target.value.length&&k?"validationErrorMessage.fieldIsRequired":t?null:F;Q(a),ee(!!a)},readonly:oe,blurred:oe,status:K?L.a.error:null,errorTextIntlId:K}),Object(i.jsx)(p.a,{placeholderIntlId:s&&!D?"homework-deadline-expired":"lecture-answer-placeholder",blurred:oe,value:re?D:null===a||void 0===a?void 0:a.body,onChange:function(e){return U(e.target.value)},readOnly:oe}),ie&&R&&a&&w&&Object(i.jsx)("p",{className:"attempts",children:T?Object(i.jsx)(l.a,{id:"maxHomeworkAttemptsCount",defaultMessage:"You used all atempts"}):Object(i.jsx)(l.a,{id:"attempts",values:{max:w,attempts:a.attempts}})}),ie&&re?Object(i.jsxs)("div",{className:"buttons-wrapper",children:[Object(i.jsx)(m.a,{onClick:function(){h(D,P),se(!1)},textIntlId:R&&a&&a.attempts>=1?"resend":"send",disabled:$}),a&&Object(i.jsx)(m.a,{onClick:function(){return se(!1)},textIntlId:"cancel",className:"cancel-button"})]}):null,ie&&!re?Object(i.jsx)(m.a,{onClick:function(){return se(!0)},textIntlId:"change"}):null]})]}),R&&ce&&a&&!a.isReviewed&&Object(i.jsx)(E,{minMark:S,userId:A,homeworkResponse:a,traceAccordingText:I,parentInstructions:ne}),Object(i.jsx)("div",{className:"lecture-task-part",children:Object(i.jsx)("div",{className:"markdown-homework",children:Object(i.jsx)(j.a,{source:t||"NA",escapeHtml:!1})})})]})}},706:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a(5),s=function(e){switch(e){case r.AutogradeErrorCode.RepoIsNotAccessible:return"autogradeError.repoIsNotAccessible";case r.AutogradeErrorCode.BuildError:return"autogradeError.buildError";default:return"autogradeError.default"}}},750:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var r=a(2),s=(a(0),a(86)),n=a(102),o=(a(767),function(e){var t=e.autogradeResult;return t&&t.trace?Object(r.jsx)("div",{className:"trace",dangerouslySetInnerHTML:{__html:t.trace}}):null}),c=(a(768),function(e){var t=e.onlyTrace,a=e.waiting,c=e.autogradeResult,i=e.errorMessage,u=e.traceAccordingText;return i?Object(r.jsx)("div",{className:"autograde-result-view",children:Object(r.jsx)("span",{className:"error-message",children:Object(r.jsx)(s.a,{id:i,defaultMessage:"Unidentified error, when trying to process your repository"})})}):a?Object(r.jsxs)("div",{className:"loader",children:[Object(r.jsx)(n.a,{}),Object(r.jsx)("span",{className:"message",children:Object(r.jsx)(s.a,{id:"autogradeResultViewWaitingMessage",defaultMessage:"Faiting for results from autograding system..."})})]}):c?Object(r.jsxs)("div",{className:"autograde-result-view",children:[Object(r.jsx)("h1",{className:"autograde-result-title",children:Object(r.jsx)(s.a,{id:"autogradeResultViewTitle",defaultMessage:"Resut from autograding system"})}),t?null:Object(r.jsxs)("div",{className:"feedback-container",children:[Object(r.jsxs)("div",{className:"autograde-mark",children:[Object(r.jsx)("span",{children:c.mark}),Object(r.jsx)("div",{className:"auto-mark-note",children:Object(r.jsx)(s.a,{id:"autogradeResultNote",defaultMessage:"Resut from autograding system (final mark can be changed)"})})]}),Object(r.jsx)("div",{className:"text-feedback",dangerouslySetInnerHTML:{__html:c.feedback}})]}),u&&Object(r.jsx)("span",{className:"trace-according-message",children:u}),Object(r.jsx)(o,{autogradeResult:c})]}):null})},767:function(e,t,a){},768:function(e,t,a){}}]);